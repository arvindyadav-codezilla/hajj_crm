import{a as W}from"./chunk-D5HNI4PZ.js";import{a as K,b as Q}from"./chunk-72ELOMN6.js";import"./chunk-I5OUGAOQ.js";import{a as q}from"./chunk-5HHLPE7X.js";import{a as F}from"./chunk-CHEZGLLC.js";import"./chunk-KRVA37OW.js";import"./chunk-T6U4U4OU.js";import{a as z,b as U}from"./chunk-GDVJ7YX6.js";import{b as $}from"./chunk-YO5MP22C.js";import{a as V,b as G}from"./chunk-4PLA5JDF.js";import{c as S,d as j,e as k,h as B,i as J,j as R,k as O,m as H}from"./chunk-6AQPRJKU.js";import"./chunk-EEUREV7G.js";import{B as c,Ca as A,Ea as m,Fa as C,H as I,I as u,Ib as P,Kb as w,Nb as _,O as E,P as D,Pa as h,Ra as v,Xa as N,ba as s,ca as p,ka as L,ma as d,n as M,s as T,ub as x,wa as o,xa as l,ya as f}from"./chunk-DSA3EB6K.js";function Z(a,e){if(a&1){let t=A();o(0,"div",6)(1,"form",11),m("ngSubmit",function(){E(t);let n=C();return D(n.onSubmit())}),o(2,"div",12),f(3,"ng-select",13),l(),o(4,"div"),f(5,"app-input",14),l()()()}if(a&2){let t=C();s(),d("formGroup",t.form),s(2),d("dropdownList",t.langTypeList)("selectedItems",t.selectedItems)("singleSelection",!0)}}function ee(a,e){a&1&&(o(0,"div",15)(1,"p",16),h(2,"Are you sure you want to delete this configuration?"),l()())}var b=class a{constructor(e,t,i,n,r,g){this.route=e;this.fb=t;this.router=i;this.languageService=n;this.configService=r;this.toast=g}form;entityType;entityData;isEditMode=!1;isDeleteMode=!1;isEditId;tableBody;entityId=null;langTypeList=[];selectedItems=[];tableHeader;tableColumn;tableData=[];isModalOpen=!1;modalTitle="";modalContent="'This is some important information inside the modal.'";modalButtonText="Submit";pagination={start:1,end:10,total:100,pages:[1,2,3,4,5],currentPage:1};apiCalled=!1;ngOnInit(){this.route.data.subscribe(e=>{this.entityType=e?.type,this.entityType?this.getApi():console.error("Entity Type is not defined")}),this.langTypeList=[{item_id:1,item_text:"Arabic"},{item_id:2,item_text:"English"}],this.form=this.fb.group({language:["",S.required],displayName:["",S.required]}),this.route.paramMap.subscribe(e=>{this.entityId=e.get("id"),this.entityId&&!this.apiCalled&&(this.isEditMode=!0,this.apiCalled=!0)})}openModal(e,t){this.isModalOpen=!0;let i={Add:"Add",Edit:"Edit",Delete:"Delete"};this.modalTitle=i[t]||"Title",!!e?(this.isEditMode=!0,this.isDeleteMode=!1,this.form.patchValue({id:e.id,language:e.language==="ar"?"Arabic":"English",displayName:e.display_name})):(this.modalTitle==="Add"?(this.isEditMode=!1,this.isDeleteMode=!1):(this.isEditMode=!1,this.isDeleteMode=!0),this.form.reset())}closeModal(){this.isModalOpen=!1}onConfirm(){console.log("Modal confirmed"),this.closeModal()}getApi(){if(!this.entityType){console.error("Entity type is not defined!");return}this.languageService.currentLang$.pipe(T(1)).subscribe(e=>{let t=this.configService.getConfig(`fields/${this.entityType}/list_type`,e),i=this.configService.getConfig(this.entityType,e);M([t,i]).subscribe(([n,r])=>{n?.model===this.entityType&&(this.tableHeader=n.fields.map(g=>g.verbose_name),this.tableColumn=n.fields.map(g=>g.name),console.log("API response: Header",this.tableHeader)),this.tableBody=r,console.log(this.tableBody,"body"),this.transformDataForTable(this.tableBody.results),console.log("API response: Body",this.tableBody)},n=>{console.error("Error fetching config:",n)})})}transformDataForTable(e){this.tableData=e?.map(t=>{let i={};return this.tableColumn.forEach(n=>{t[n]&&typeof t[n]=="object"?i[n]=t[n].key?t[n].key:t[n].name?t[n].name:t[n].display_name?t[n].display_name:"":i[n]=t[n]}),i}),this.pagination.total=this.tableBody.count,this.updatePagination()}handleAction(e){e.action==="edit"?(this.openModal(e.rowData,"Edit"),this.isEditId=e.rowData.id,console.log(e.action)):e.action==="delete"&&(this.openModal("","Delete"),this.isEditId=e.rowData.id)}editRow(e){console.log("Edit row:",e),this.form.patchValue({id:e.id,language:e.language==="ar"?"Arabic":"English",displayName:e.display_name})}updatePagination(){let e=Math.ceil(this.pagination.total/10);this.pagination.pages=Array.from({length:e},(n,r)=>r+1);let t=(this.pagination.currentPage-1)*10,i=this.pagination.currentPage*10;this.pagination.start=t+1,this.pagination.end=i>this.pagination.total?this.pagination.total:i,this.tableData=this.tableData?.slice(t,i)}onPageChange(e){console.log(e)}onNextPage(){this.pagination.currentPage<this.pagination.pages.length&&(this.pagination.currentPage++,this.updatePagination())}onPreviousPage(){this.pagination.currentPage>1&&(this.pagination.currentPage--,this.updatePagination())}handleSelectionChange(e){this.selectedItems=e}onDelete(){this.languageService.currentLang$.subscribe(e=>{this.configService.deleteConfig(this.entityType,this.isEditId,e).subscribe(t=>{this.toast.success("Deleted successfully!"),this.closeModal(),this.apiCalled=!1,this.getApi()},t=>{this.toast.error("Delete Failed!")})})}onSubmit(){if(this.form.valid){let e=this.form.value,t={translations:[{language:"ar",display_name:e.displayName},{language:e.language[0].item_text==="Arabic"?"ar":"en",display_name:e.displayName}]};this.isEditMode?this.languageService.currentLang$.subscribe(i=>{this.configService.updateConfig(this.entityType,this.isEditId,t,i).subscribe(n=>{this.toast.success("Updated successfully!"),this.closeModal(),this.apiCalled=!1,this.getApi()},n=>{this.toast.error("Update Failed!")})}):this.languageService.currentLang$.subscribe(i=>{this.configService.createConfig(this.entityType,t,i).subscribe(n=>{this.toast.success(`${this.entityType} Created successfully!`),this.closeModal(),this.apiCalled=!1,this.getApi()},n=>{this.toast.error("Creation Failed!")})})}}static \u0275fac=function(t){return new(t||a)(p(P),p(O),p(w),p(F),p(W),p(q))};static \u0275cmp=I({type:a,selectors:[["app-job-listing"]],standalone:!0,features:[N],decls:13,vars:14,consts:[[1,"flex","flex-col","gap-5"],[1,"w-[100%]","flex","justify-between"],[1,"text-2xl","font-semibold","text-gray-700","capitalize"],[1,"text-white","rounded-lg",3,"click"],[1,"flex","items-center","gap-2","capitalize"],["src","assets/icons/heroicons/outline/plus.svg",1,"w-6","h-6","inline-flex"],[1,"w-[100%]"],[3,"onActionClick","pageChange","tableHeaders","tableColumn","tableData","showCheckboxes","showPagination","pagination"],[3,"close","confirm","isOpen","title","content","buttonText"],["class","w-[100%]",4,"ngIf"],["class","space-y-4 py-5 text-center",4,"ngIf"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"my-5"],["label","Language","formControlName","language","placeholder","Choose language","onSelectionChange","handleSelectionChange($event)",3,"dropdownList","selectedItems","singleSelection"],["formControlName","displayName","classNames","border-[#EFF0F6] min-h-[50px] p-2 rounded text-[16px]","placeholder","Enter name","label","displayName"],[1,"space-y-4","py-5","text-center"],[1,"text-lg","text-gray-700"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"div",1)(2,"h2",2),h(3),l(),o(4,"app-button",3),m("click",function(){return i.openModal("","Add")}),o(5,"div",4),f(6,"svg-icon",5),h(7),l()()(),o(8,"div",6)(9,"app-data-table",7),m("onActionClick",function(r){return i.handleAction(r)})("pageChange",function(r){return i.onPageChange(r)}),l()()(),o(10,"app-modal",8),m("close",function(){return i.closeModal()})("confirm",function(){return i.isDeleteMode?i.onDelete():i.onSubmit()}),L(11,Z,6,4,"div",9)(12,ee,3,0,"div",10),l()),t&2&&(s(3),v(" ",i.entityType," "),s(4),v(" Add ",i.entityType," "),s(2),d("tableHeaders",i.tableColumn)("tableColumn",i.tableHeader)("tableData",i.tableData)("showCheckboxes",!0)("showPagination",!0)("pagination",i.pagination),s(),d("isOpen",i.isModalOpen)("title",i.modalTitle)("content",i.modalContent)("buttonText",i.modalButtonText),s(),d("ngIf",!i.isDeleteMode),s(),d("ngIf",i.isDeleteMode))},dependencies:[H,B,j,k,J,R,x,$,U,z,V,G,K,Q]})};var te=[{path:"job-application",component:b,data:{type:"job-application"}}],y=class a{static \u0275fac=function(t){return new(t||a)};static \u0275mod=u({type:a});static \u0275inj=c({imports:[_.forChild(te),_]})};var Y=class a{static \u0275fac=function(t){return new(t||a)};static \u0275mod=u({type:a});static \u0275inj=c({imports:[y]})};export{Y as JobListingModule};
