import{a as ee,b as te}from"./chunk-72ELOMN6.js";import"./chunk-I5OUGAOQ.js";import{a as W}from"./chunk-5HHLPE7X.js";import{a as k}from"./chunk-CHEZGLLC.js";import{b as m,c as Z}from"./chunk-KRVA37OW.js";import{a as O}from"./chunk-T6U4U4OU.js";import{a as X,b as Y}from"./chunk-GDVJ7YX6.js";import{a as K,b as Q}from"./chunk-4PLA5JDF.js";import{c as R,d as L,e as B,h as U,i as V,j as z,k as J,m as q}from"./chunk-6AQPRJKU.js";import"./chunk-EEUREV7G.js";import{A as T,B as u,Ca as P,D as b,Ea as d,Fa as _,H as D,I as g,Ib as j,Kb as H,Nb as I,O as A,P as F,Pa as h,Ra as S,Xa as x,Ya as w,ba as s,ca as p,ka as E,ma as c,ub as G,wa as r,xa as l,ya as C,yb as $,zb as N}from"./chunk-DSA3EB6K.js";var f=class o{constructor(e,t){this.http=e;this.authService=t}apiUrl=O.HAJJ_APP_API_URL;getAuthHeaders(){let e=this.authService.getToken(),t=new $;return e&&(t=t.append("Authorization",`Bearer ${e}`)),t}getConfig(e,t){let i=this.getAuthHeaders();return this.http.get(`${this.apiUrl}${m.get(t)}/${e}/`,{headers:i})}createConfig(e,t,i){let n=this.getAuthHeaders();return this.http.post(`${this.apiUrl}${m.Post(i)}/${e}/create/`,t,{headers:n})}updateConfig(e,t,i,n){let a=this.getAuthHeaders();return this.http.patch(`${this.apiUrl}${m.Put(n)}/${e}/${t}/update/`,i,{headers:a})}deleteConfig(e,t,i){let n=this.getAuthHeaders();return this.http.delete(`${this.apiUrl}${m.Delete(i)}/${e}/${t}/delete/`,{headers:n})}static \u0275fac=function(t){return new(t||o)(b(N),b(Z))};static \u0275prov=T({token:o,factory:o.\u0275fac,providedIn:"root"})};var ne=()=>["Id","Name","Permission"];function re(o,e){if(o&1){let t=P();r(0,"div",6)(1,"form",11),d("ngSubmit",function(){A(t);let n=_();return F(n.onSubmit())}),r(2,"div"),C(3,"app-input",12),l()()()}if(o&2){let t=_();s(),c("formGroup",t.form)}}function ae(o,e){o&1&&(r(0,"div",13)(1,"p",14),h(2,"Are you sure you want to delete this configuration?"),l()())}var y=class o{constructor(e,t,i,n,a,pe){this.route=e;this.fb=t;this.router=i;this.languageService=n;this.groupsService=a;this.toast=pe}form;entityType;entityData;isEditMode=!1;isDeleteMode=!1;isEditId;configData;entityId=null;selectedItems=[];tableData=[];isModalOpen=!1;modalTitle="";modalContent="'This is some important information inside the modal.'";modalButtonText="Submit";pagination={start:1,end:10,total:100,pages:[1,2,3,4,5],currentPage:1};ngOnInit(){this.route.data.subscribe(e=>{this.entityType=e?.type,console.log("Entity Type:",this.entityType),this.entityType?this.getApi():console.error("Entity Type is not defined")}),this.form=this.fb.group({name:["",R.required]}),this.route.paramMap.subscribe(e=>{this.entityId=e.get("id"),this.entityId&&(this.isEditMode=!0,this.loadEntityData())})}loadEntityData(){this.entityId&&this.languageService.currentLang$.subscribe(e=>{this.groupsService.getConfig(this.entityType,e).subscribe(t=>{let i=t.find(n=>n.id===this.entityId);i?this.form.patchValue({name:i.name}):console.error("Entity not found in data:",this.entityId)})})}openModal(e,t){this.isModalOpen=!0;let i={Add:"Add",Edit:"Edit",Delete:"Delete"};this.modalTitle=i[t]||"Title",!!e?(this.isEditMode=!0,this.isDeleteMode=!1,this.form.patchValue({id:e.id,name:e.name})):(this.modalTitle==="Add"?(this.isEditMode=!1,this.isDeleteMode=!1):(this.isEditMode=!1,this.isDeleteMode=!0),this.form.reset())}closeModal(){this.isModalOpen=!1}onConfirm(){console.log("Modal confirmed"),this.closeModal()}getApi(){if(!this.entityType){console.error("Entity type is not defined!");return}this.languageService.currentLang$.subscribe(e=>{this.groupsService.getConfig(this.entityType,e).subscribe(t=>{this.configData=t.data},t=>{console.error("Error fetching config:",t)})})}handleAction(e){e.action==="edit"?(this.openModal(e.rowData,"Edit"),this.isEditId=e.rowData.id,console.log(e.action)):e.action==="delete"&&(this.openModal("","Delete"),this.isEditId=e.rowData.id)}editRow(e){console.log("Edit row:",e),this.form.patchValue({id:e.id,name:e.name})}updatePagination(){let e=Math.ceil(this.pagination.total/10);this.pagination.pages=Array.from({length:e},(n,a)=>a+1);let t=(this.pagination.currentPage-1)*10,i=this.pagination.currentPage*10;this.pagination.start=t+1,this.pagination.end=i>this.pagination.total?this.pagination.total:i,this.tableData=this.tableData.slice(t,i)}onPageChange(e){this.pagination.currentPage=e,this.updatePagination()}onNextPage(){this.pagination.currentPage<this.pagination.pages.length&&(this.pagination.currentPage++,this.updatePagination())}onPreviousPage(){this.pagination.currentPage>1&&(this.pagination.currentPage--,this.updatePagination())}handleSelectionChange(e){this.selectedItems=e}onDelete(){this.languageService.currentLang$.subscribe(e=>{this.groupsService.deleteConfig(this.entityType,this.isEditId,e).subscribe(t=>{this.toast.success("Deleted successfully!"),this.closeModal(),this.getApi()},t=>{this.toast.error("Delete Failed!")})})}onSubmit(){if(this.form.valid){let e=this.form.value;this.isEditMode?this.languageService.currentLang$.subscribe(t=>{this.groupsService.updateConfig(this.entityType,this.isEditId,e,t).subscribe(i=>{this.toast.success("Updated successfully!"),this.closeModal(),this.getApi()},i=>{this.toast.error("Updated Failed!")})}):this.languageService.currentLang$.subscribe(t=>{this.groupsService.createConfig(this.entityType,e,t).subscribe(i=>{this.toast.success(`${this.entityType} Created successfully!`),this.closeModal(),this.getApi()},i=>{this.toast.error("Creation Failed!")})})}}static \u0275fac=function(t){return new(t||o)(p(j),p(J),p(H),p(k),p(f),p(W))};static \u0275cmp=D({type:o,selectors:[["app-groups-form"]],standalone:!0,features:[x],decls:13,vars:14,consts:[[1,"flex","flex-col","gap-5"],[1,"w-[100%]","flex","justify-between"],[1,"text-2xl","font-semibold","text-gray-700","capitalize"],[1,"text-white","rounded-lg",3,"click"],[1,"flex","items-center","gap-2","capitalize"],["src","assets/icons/heroicons/outline/plus.svg",1,"w-6","h-6","inline-flex"],[1,"w-[100%]"],[3,"onActionClick","pageChange","tableHeaders","tableData","showCheckboxes","showPagination","pagination"],[3,"close","confirm","isOpen","title","content","buttonText"],["class","w-[100%]",4,"ngIf"],["class","space-y-4 py-5 text-center",4,"ngIf"],[1,"space-y-4",3,"ngSubmit","formGroup"],["formControlName","name","classNames","border-[#EFF0F6] min-h-[50px] p-2 rounded text-[16px]","placeholder","Enter name","label","Name"],[1,"space-y-4","py-5","text-center"],[1,"text-lg","text-gray-700"]],template:function(t,i){t&1&&(r(0,"div",0)(1,"div",1)(2,"h2",2),h(3),l(),r(4,"app-button",3),d("click",function(){return i.openModal("","Add")}),r(5,"div",4),C(6,"svg-icon",5),h(7),l()()(),r(8,"div",6)(9,"app-data-table",7),d("onActionClick",function(a){return i.handleAction(a)})("pageChange",function(a){return i.onPageChange(a)}),l()()(),r(10,"app-modal",8),d("close",function(){return i.closeModal()})("confirm",function(){return i.isDeleteMode?i.onDelete():i.onSubmit()}),E(11,re,4,1,"div",9)(12,ae,3,0,"div",10),l()),t&2&&(s(3),S(" ",i.entityType," "),s(4),S(" Add ",i.entityType," "),s(2),c("tableHeaders",w(13,ne))("tableData",i.configData)("showCheckboxes",!0)("showPagination",!0)("pagination",i.pagination),s(),c("isOpen",i.isModalOpen)("title",i.modalTitle)("content",i.modalContent)("buttonText",i.modalButtonText),s(),c("ngIf",!i.isDeleteMode),s(),c("ngIf",i.isDeleteMode))},dependencies:[q,U,L,B,V,z,G,Y,X,K,Q,ee,te]})};var se=[{path:"groups",component:y,data:{type:"groups"}}],v=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=g({type:o});static \u0275inj=u({imports:[I.forChild(se),I]})};var ie=class o{static \u0275fac=function(t){return new(t||o)};static \u0275mod=g({type:o});static \u0275inj=u({imports:[v]})};export{ie as GroupsModule};
