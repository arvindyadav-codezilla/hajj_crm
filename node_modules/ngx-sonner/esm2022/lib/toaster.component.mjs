import { isPlatformBrowser } from '@angular/common';
import { booleanAttribute, ChangeDetectionStrategy, Component, computed, effect, inject, input, numberAttribute, PLATFORM_ID, signal, untracked, viewChild, ViewEncapsulation, } from '@angular/core';
import { IconComponent } from './icon.component';
import { GAP, TOAST_LIFETIME, TOAST_WIDTH, VIEWPORT_OFFSET, VISIBLE_TOASTS_AMOUNT, } from './internal/constants';
import { LoaderComponent } from './loader.component';
import { ToastFilterPipe } from './pipes/toast-filter.pipe';
import { toastState } from './state';
import { ToastComponent } from './toast.component';
import * as i0 from "@angular/core";
// eslint-disable-next-line @angular-eslint/component-class-suffix
export class NgxSonnerToaster {
    constructor() {
        this.platformId = inject(PLATFORM_ID);
        this.toasts = toastState.toasts;
        this.heights = toastState.heights;
        this.reset = toastState.reset;
        this.invert = input(false, {
            transform: booleanAttribute,
        });
        this.theme = input('light');
        this.position = input('bottom-right');
        this.hotKey = input(['altKey', 'KeyT']);
        this.richColors = input(false, {
            transform: booleanAttribute,
        });
        this.expand = input(false, {
            transform: booleanAttribute,
        });
        this.duration = input(TOAST_LIFETIME, {
            transform: numberAttribute,
        });
        this.visibleToasts = input(VISIBLE_TOASTS_AMOUNT, { transform: numberAttribute });
        this.closeButton = input(false, {
            transform: booleanAttribute,
        });
        this.toastOptions = input({});
        this.offset = input(null);
        this.dir = input(this.getDocumentDirection());
        this._class = input('', { alias: 'class' });
        this._style = input({}, { alias: 'style' });
        this.possiblePositions = computed(() => Array.from(new Set([
            this.position(),
            ...this.toasts()
                .filter(toast => toast.position)
                .map(toast => toast.position),
        ].filter(Boolean))));
        this.expanded = signal(false);
        this.interacting = signal(false);
        this.actualTheme = signal(this.getActualTheme(this.theme()));
        this.listRef = viewChild('listRef');
        this.lastFocusedElementRef = signal(null);
        this.isFocusWithinRef = signal(false);
        this.hotKeyLabel = computed(() => this.hotKey().join('+').replace(/Key/g, '').replace(/Digit/g, ''));
        this.toasterStyles = computed(() => ({
            '--front-toast-height': `${this.heights()[0]?.height}px`,
            '--offset': typeof this.offset() === 'number'
                ? `${this.offset()}px`
                : this.offset() ?? `${VIEWPORT_OFFSET}`,
            '--width': `${TOAST_WIDTH}px`,
            '--gap': `${GAP}px`,
            ...this._style(),
        }));
        this.handleKeydown = (event) => {
            const listRef = this.listRef()?.nativeElement;
            if (!listRef)
                return;
            const isHotkeyPressed = this.hotKey().every(key => event[key] || event.code === key);
            if (isHotkeyPressed) {
                this.expanded.set(true);
                listRef.focus();
            }
            if (event.code === 'Escape' &&
                (document.activeElement === listRef ||
                    listRef.contains(document.activeElement))) {
                this.expanded.set(false);
            }
        };
        this.handleThemePreferenceChange = ({ matches }) => {
            if (this.theme() === 'system') {
                this.actualTheme.set(matches ? 'dark' : 'light');
            }
        };
        this.reset();
        if (isPlatformBrowser(this.platformId)) {
            document.addEventListener('keydown', this.handleKeydown);
            window
                .matchMedia('(prefers-color-scheme: dark)')
                .addEventListener('change', this.handleThemePreferenceChange);
        }
        effect(() => {
            if (this.toasts().length >= 1) {
                untracked(() => this.expanded.set(false));
            }
        });
        effect(() => {
            const theme = this.theme();
            untracked(() => this.actualTheme.set(this.getActualTheme(theme)));
        });
    }
    ngOnDestroy() {
        if (isPlatformBrowser(this.platformId)) {
            document.removeEventListener('keydown', this.handleKeydown);
            window
                .matchMedia('(prefers-color-scheme: dark)')
                .removeEventListener('change', this.handleThemePreferenceChange);
        }
    }
    handleBlur(event) {
        if (this.isFocusWithinRef() &&
            !event.target.contains(event.relatedTarget)) {
            this.isFocusWithinRef.set(false);
            if (this.lastFocusedElementRef()) {
                this.lastFocusedElementRef()?.focus({ preventScroll: true });
                this.lastFocusedElementRef.set(null);
            }
        }
    }
    handleFocus(event) {
        const isNotDismissible = event.target instanceof HTMLElement &&
            event.target.dataset['dismissible'] === 'false';
        if (isNotDismissible)
            return;
        if (!this.isFocusWithinRef()) {
            this.isFocusWithinRef.set(true);
            this.lastFocusedElementRef.set(event.relatedTarget);
        }
    }
    handlePointerDown(event) {
        const isNotDismissible = event.target instanceof HTMLElement &&
            event.target.dataset['dismissible'] === 'false';
        if (isNotDismissible)
            return;
        this.interacting.set(true);
    }
    handleMouseLeave() {
        if (!this.interacting()) {
            this.expanded.set(false);
        }
    }
    getActualTheme(t) {
        if (t !== 'system') {
            return t;
        }
        if (isPlatformBrowser(this.platformId)) {
            if (window.matchMedia &&
                window.matchMedia('(prefers-color-scheme: dark)').matches) {
                return 'dark';
            }
            return 'light';
        }
        return 'light';
    }
    getDocumentDirection() {
        if (typeof window === 'undefined')
            return 'ltr';
        if (typeof document === 'undefined')
            return 'ltr'; // For Fresh purpose
        const dirAttribute = document.documentElement.getAttribute('dir');
        if (dirAttribute === 'auto' || !dirAttribute) {
            return window.getComputedStyle(document.documentElement)
                .direction;
        }
        return dirAttribute;
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.0.1", ngImport: i0, type: NgxSonnerToaster, deps: [], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "17.0.0", version: "18.0.1", type: NgxSonnerToaster, isStandalone: true, selector: "ngx-sonner-toaster", inputs: { invert: { classPropertyName: "invert", publicName: "invert", isSignal: true, isRequired: false, transformFunction: null }, theme: { classPropertyName: "theme", publicName: "theme", isSignal: true, isRequired: false, transformFunction: null }, position: { classPropertyName: "position", publicName: "position", isSignal: true, isRequired: false, transformFunction: null }, hotKey: { classPropertyName: "hotKey", publicName: "hotKey", isSignal: true, isRequired: false, transformFunction: null }, richColors: { classPropertyName: "richColors", publicName: "richColors", isSignal: true, isRequired: false, transformFunction: null }, expand: { classPropertyName: "expand", publicName: "expand", isSignal: true, isRequired: false, transformFunction: null }, duration: { classPropertyName: "duration", publicName: "duration", isSignal: true, isRequired: false, transformFunction: null }, visibleToasts: { classPropertyName: "visibleToasts", publicName: "visibleToasts", isSignal: true, isRequired: false, transformFunction: null }, closeButton: { classPropertyName: "closeButton", publicName: "closeButton", isSignal: true, isRequired: false, transformFunction: null }, toastOptions: { classPropertyName: "toastOptions", publicName: "toastOptions", isSignal: true, isRequired: false, transformFunction: null }, offset: { classPropertyName: "offset", publicName: "offset", isSignal: true, isRequired: false, transformFunction: null }, dir: { classPropertyName: "dir", publicName: "dir", isSignal: true, isRequired: false, transformFunction: null }, _class: { classPropertyName: "_class", publicName: "class", isSignal: true, isRequired: false, transformFunction: null }, _style: { classPropertyName: "_style", publicName: "style", isSignal: true, isRequired: false, transformFunction: null } }, viewQueries: [{ propertyName: "listRef", first: true, predicate: ["listRef"], descendants: true, isSignal: true }], ngImport: i0, template: `
    @if (toasts().length > 0) {
      <section
        [attr.aria-label]="'Notifications ' + hotKeyLabel()"
        [tabIndex]="-1">
        @for (pos of possiblePositions(); track pos) {
          <ol
            #listRef
            [tabIndex]="-1"
            [class]="_class()"
            data-sonner-toaster
            [attr.data-theme]="actualTheme()"
            [attr.data-rich-colors]="richColors()"
            [attr.dir]="dir() === 'auto' ? getDocumentDirection() : dir()"
            [attr.data-y-position]="pos.split('-')[0]"
            [attr.data-x-position]="pos.split('-')[1]"
            (blur)="handleBlur($event)"
            (focus)="handleFocus($event)"
            (mouseenter)="expanded.set(true)"
            (mousemove)="expanded.set(true)"
            (mouseleave)="handleMouseLeave()"
            (pointerdown)="handlePointerDown($event)"
            (pointerup)="interacting.set(false)"
            [style]="toasterStyles()">
            @for (
              toast of toasts() | toastFilter: $index : pos;
              track toast.id
            ) {
              <ngx-sonner-toast
                [index]="$index"
                [toast]="toast"
                [invert]="invert()"
                [visibleToasts]="visibleToasts()"
                [closeButton]="closeButton()"
                [interacting]="interacting()"
                [position]="position()"
                [expandByDefault]="expand()"
                [expanded]="expanded()"
                [actionButtonStyle]="toastOptions().actionButtonStyle"
                [cancelButtonStyle]="toastOptions().cancelButtonStyle"
                [class]="toastOptions().class ?? ''"
                [descriptionClass]="toastOptions().descriptionClass ?? ''"
                [classes]="toastOptions().classes ?? {}"
                [duration]="toastOptions().duration ?? duration()"
                [unstyled]="toastOptions().unstyled ?? false">
                <ng-content select="[loading-icon]" loading-icon>
                  <ngx-sonner-loader [isVisible]="toast.type === 'loading'" />
                </ng-content>
                <ng-content select="[success-icon]" success-icon>
                  <ngx-sonner-icon type="success" />
                </ng-content>
                <ng-content select="[error-icon]" error-icon>
                  <ngx-sonner-icon type="error" />
                </ng-content>
                <ng-content select="[warning-icon]" warning-icon>
                  <ngx-sonner-icon type="warning" />
                </ng-content>
                <ng-content select="[info-icon]" info-icon>
                  <ngx-sonner-icon type="info" />
                </ng-content>
              </ngx-sonner-toast>
            }
          </ol>
        }
      </section>
    }
  `, isInline: true, styles: ["html[dir=ltr],[data-sonner-toaster][dir=ltr]{--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}html[dir=rtl],[data-sonner-toaster][dir=rtl]{--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}[data-sonner-toaster][data-x-position=right]{right:max(var(--offset),env(safe-area-inset-right))}[data-sonner-toaster][data-x-position=left]{left:max(var(--offset),env(safe-area-inset-left))}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translate(-50%)}[data-sonner-toaster][data-y-position=top]{top:max(var(--offset),env(safe-area-inset-top))}[data-sonner-toaster][data-y-position=bottom]{bottom:max(var(--offset),env(safe-area-inset-bottom))}[data-sonner-toast]{--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast][data-y-position=top]{top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}[data-sonner-toast] [data-description]{font-weight:400;line-height:1.4;color:inherit}[data-sonner-toast] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast] [data-icon]>*{flex-shrink:0}[data-sonner-toast] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast] [data-button]:focus-visible{box-shadow:0 0 0 2px #0006}[data-sonner-toast] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast] [data-cancel]{color:var(--normal-text);background:#00000014}[data-sonner-toast][data-theme=dark] [data-cancel]{background:#ffffff4d}[data-sonner-toast] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]:before{content:\"\";position:absolute;left:0;right:0;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]:before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]:before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]:before{content:\"\";position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast]:after{content:\"\";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y: translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y: translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]:before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - 32px)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true] [data-sonner-toast][data-type=success],[data-rich-colors=true] [data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true] [data-sonner-toast][data-type=info],[data-rich-colors=true] [data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true] [data-sonner-toast][data-type=warning],[data-rich-colors=true] [data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true] [data-sonner-toast][data-type=error],[data-rich-colors=true] [data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}\n"], dependencies: [{ kind: "component", type: ToastComponent, selector: "ngx-sonner-toast", inputs: ["toast", "index", "expanded", "invert", "position", "visibleToasts", "expandByDefault", "closeButton", "interacting", "cancelButtonStyle", "actionButtonStyle", "duration", "descriptionClass", "classes", "unstyled", "class", "style"] }, { kind: "pipe", type: ToastFilterPipe, name: "toastFilter" }, { kind: "component", type: IconComponent, selector: "ngx-sonner-icon", inputs: ["type"] }, { kind: "component", type: LoaderComponent, selector: "ngx-sonner-loader", inputs: ["isVisible"] }], changeDetection: i0.ChangeDetectionStrategy.OnPush, encapsulation: i0.ViewEncapsulation.None }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.0.1", ngImport: i0, type: NgxSonnerToaster, decorators: [{
            type: Component,
            args: [{ selector: 'ngx-sonner-toaster', standalone: true, imports: [ToastComponent, ToastFilterPipe, IconComponent, LoaderComponent], template: `
    @if (toasts().length > 0) {
      <section
        [attr.aria-label]="'Notifications ' + hotKeyLabel()"
        [tabIndex]="-1">
        @for (pos of possiblePositions(); track pos) {
          <ol
            #listRef
            [tabIndex]="-1"
            [class]="_class()"
            data-sonner-toaster
            [attr.data-theme]="actualTheme()"
            [attr.data-rich-colors]="richColors()"
            [attr.dir]="dir() === 'auto' ? getDocumentDirection() : dir()"
            [attr.data-y-position]="pos.split('-')[0]"
            [attr.data-x-position]="pos.split('-')[1]"
            (blur)="handleBlur($event)"
            (focus)="handleFocus($event)"
            (mouseenter)="expanded.set(true)"
            (mousemove)="expanded.set(true)"
            (mouseleave)="handleMouseLeave()"
            (pointerdown)="handlePointerDown($event)"
            (pointerup)="interacting.set(false)"
            [style]="toasterStyles()">
            @for (
              toast of toasts() | toastFilter: $index : pos;
              track toast.id
            ) {
              <ngx-sonner-toast
                [index]="$index"
                [toast]="toast"
                [invert]="invert()"
                [visibleToasts]="visibleToasts()"
                [closeButton]="closeButton()"
                [interacting]="interacting()"
                [position]="position()"
                [expandByDefault]="expand()"
                [expanded]="expanded()"
                [actionButtonStyle]="toastOptions().actionButtonStyle"
                [cancelButtonStyle]="toastOptions().cancelButtonStyle"
                [class]="toastOptions().class ?? ''"
                [descriptionClass]="toastOptions().descriptionClass ?? ''"
                [classes]="toastOptions().classes ?? {}"
                [duration]="toastOptions().duration ?? duration()"
                [unstyled]="toastOptions().unstyled ?? false">
                <ng-content select="[loading-icon]" loading-icon>
                  <ngx-sonner-loader [isVisible]="toast.type === 'loading'" />
                </ng-content>
                <ng-content select="[success-icon]" success-icon>
                  <ngx-sonner-icon type="success" />
                </ng-content>
                <ng-content select="[error-icon]" error-icon>
                  <ngx-sonner-icon type="error" />
                </ng-content>
                <ng-content select="[warning-icon]" warning-icon>
                  <ngx-sonner-icon type="warning" />
                </ng-content>
                <ng-content select="[info-icon]" info-icon>
                  <ngx-sonner-icon type="info" />
                </ng-content>
              </ngx-sonner-toast>
            }
          </ol>
        }
      </section>
    }
  `, encapsulation: ViewEncapsulation.None, changeDetection: ChangeDetectionStrategy.OnPush, styles: ["html[dir=ltr],[data-sonner-toaster][dir=ltr]{--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}html[dir=rtl],[data-sonner-toaster][dir=rtl]{--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999}[data-sonner-toaster][data-x-position=right]{right:max(var(--offset),env(safe-area-inset-right))}[data-sonner-toaster][data-x-position=left]{left:max(var(--offset),env(safe-area-inset-left))}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translate(-50%)}[data-sonner-toaster][data-y-position=top]{top:max(var(--offset),env(safe-area-inset-top))}[data-sonner-toaster][data-y-position=bottom]{bottom:max(var(--offset),env(safe-area-inset-bottom))}[data-sonner-toast]{--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast][data-y-position=top]{top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}[data-sonner-toast] [data-description]{font-weight:400;line-height:1.4;color:inherit}[data-sonner-toast] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast] [data-icon]>*{flex-shrink:0}[data-sonner-toast] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast] [data-button]:focus-visible{box-shadow:0 0 0 2px #0006}[data-sonner-toast] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast] [data-cancel]{color:var(--normal-text);background:#00000014}[data-sonner-toast][data-theme=dark] [data-cancel]{background:#ffffff4d}[data-sonner-toast] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;background:var(--gray1);color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]:focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}[data-sonner-toast] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]:before{content:\"\";position:absolute;left:0;right:0;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]:before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]:before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]:before{content:\"\";position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast]:after{content:\"\";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y: translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y: translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]:before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount, 0px));transition:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation:swipe-out .2s ease-out forwards}@keyframes swipe-out{0%{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount)));opacity:1}to{transform:translateY(calc(var(--lift) * var(--offset) + var(--swipe-amount) + var(--lift) * -100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;--mobile-offset: 16px;right:var(--mobile-offset);left:var(--mobile-offset);width:100%}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - 32px)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset)}[data-sonner-toaster][data-y-position=bottom]{bottom:20px}[data-sonner-toaster][data-y-position=top]{top:20px}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset);right:var(--mobile-offset);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-rich-colors=true] [data-sonner-toast][data-type=success],[data-rich-colors=true] [data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true] [data-sonner-toast][data-type=info],[data-rich-colors=true] [data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true] [data-sonner-toast][data-type=warning],[data-rich-colors=true] [data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true] [data-sonner-toast][data-type=error],[data-rich-colors=true] [data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}\n"] }]
        }], ctorParameters: () => [] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9hc3Rlci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9saWJzL25neC1zb25uZXIvc3JjL2xpYi90b2FzdGVyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxpQkFBaUIsQ0FBQztBQUNwRCxPQUFPLEVBQ0wsZ0JBQWdCLEVBQ2hCLHVCQUF1QixFQUN2QixTQUFTLEVBQ1QsUUFBUSxFQUNSLE1BQU0sRUFFTixNQUFNLEVBQ04sS0FBSyxFQUNMLGVBQWUsRUFFZixXQUFXLEVBQ1gsTUFBTSxFQUNOLFNBQVMsRUFDVCxTQUFTLEVBQ1QsaUJBQWlCLEdBQ2xCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNqRCxPQUFPLEVBQ0wsR0FBRyxFQUNILGNBQWMsRUFDZCxXQUFXLEVBQ1gsZUFBZSxFQUNmLHFCQUFxQixHQUN0QixNQUFNLHNCQUFzQixDQUFDO0FBQzlCLE9BQU8sRUFBRSxlQUFlLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNyRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUFDNUQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUNyQyxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7O0FBOEVuRCxrRUFBa0U7QUFDbEUsTUFBTSxPQUFPLGdCQUFnQjtJQXdFM0I7UUF2RWlCLGVBQVUsR0FBRyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUM7UUFFbEQsV0FBTSxHQUFHLFVBQVUsQ0FBQyxNQUFNLENBQUM7UUFDM0IsWUFBTyxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUM7UUFDN0IsVUFBSyxHQUFHLFVBQVUsQ0FBQyxLQUFLLENBQUM7UUFFekIsV0FBTSxHQUFHLEtBQUssQ0FBMkMsS0FBSyxFQUFF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QUFlLENBQUM7aUJBQ3JELFNBQWdDLENBQUM7UUFDdEMsQ0FBQztRQUVELE9BQU8sWUFBbUMsQ0FBQztJQUM3QyxDQUFDOzhHQTdNVSxnQkFBZ0I7a0dBQWhCLGdCQUFnQix3OERBeEVqQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBa0VULG9vWUFuRVMsY0FBYywyU0FBRSxlQUFlLG9EQUFFLGFBQWEsOEVBQUUsZUFBZTs7MkZBeUU5RCxnQkFBZ0I7a0JBNUU1QixTQUFTOytCQUNFLG9CQUFvQixjQUNsQixJQUFJLFdBQ1AsQ0FBQyxjQUFjLEVBQUUsZUFBZSxFQUFFLGFBQWEsRUFBRSxlQUFlLENBQUMsWUFDaEU7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztHQWtFVCxpQkFFYyxpQkFBaUIsQ0FBQyxJQUFJLG1CQUNwQix1QkFBdUIsQ0FBQyxNQUFNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHtcbiAgYm9vbGVhbkF0dHJpYnV0ZSxcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENvbXBvbmVudCxcbiAgY29tcHV0ZWQsXG4gIGVmZmVjdCxcbiAgRWxlbWVudFJlZixcbiAgaW5qZWN0LFxuICBpbnB1dCxcbiAgbnVtYmVyQXR0cmlidXRlLFxuICBPbkRlc3Ryb3ksXG4gIFBMQVRGT1JNX0lELFxuICBzaWduYWwsXG4gIHVudHJhY2tlZCxcbiAgdmlld0NoaWxkLFxuICBWaWV3RW5jYXBzdWxhdGlvbixcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBJY29uQ29tcG9uZW50IH0gZnJvbSAnLi9pY29uLmNvbXBvbmVudCc7XG5pbXBvcnQge1xuICBHQVAsXG4gIFRPQVNUX0xJRkVUSU1FLFxuICBUT0FTVF9XSURUSCxcbiAgVklFV1BPUlRfT0ZGU0VULFxuICBWSVNJQkxFX1RPQVNUU19BTU9VTlQsXG59IGZyb20gJy4vaW50ZXJuYWwvY29uc3RhbnRzJztcbmltcG9ydCB7IExvYWRlckNvbXBvbmVudCB9IGZyb20gJy4vbG9hZGVyLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBUb2FzdEZpbHRlclBpcGUgfSBmcm9tICcuL3BpcGVzL3RvYXN0LWZpbHRlci5waXBlJztcbmltcG9ydCB7IHRvYXN0U3RhdGUgfSBmcm9tICcuL3N0YXRlJztcbmltcG9ydCB7IFRvYXN0Q29tcG9uZW50IH0gZnJvbSAnLi90b2FzdC5jb21wb25lbnQnO1xuaW1wb3J0IHsgUG9zaXRpb24sIFRoZW1lLCBUb2FzdGVyUHJvcHMgfSBmcm9tICcuL3R5cGVzJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LXNvbm5lci10b2FzdGVyJyxcbiAgc3RhbmRhbG9uZTogdHJ1ZSxcbiAgaW1wb3J0czogW1RvYXN0Q29tcG9uZW50LCBUb2FzdEZpbHRlclBpcGUsIEljb25Db21wb25lbnQsIExvYWRlckNvbXBvbmVudF0sXG4gIHRlbXBsYXRlOiBgXG4gICAgQGlmICh0b2FzdHMoKS5sZW5ndGggPiAwKSB7XG4gICAgICA8c2VjdGlvblxuICAgICAgICBbYXR0ci5hcmlhLWxhYmVsXT1cIidOb3RpZmljYXRpb25zICcgKyBob3RLZXlMYWJlbCgpXCJcbiAgICAgICAgW3RhYkluZGV4XT1cIi0xXCI+XG4gICAgICAgIEBmb3IgKHBvcyBvZiBwb3NzaWJsZVBvc2l0aW9ucygpOyB0cmFjayBwb3MpIHtcbiAgICAgICAgICA8b2xcbiAgICAgICAgICAgICNsaXN0UmVmXG4gICAgICAgICAgICBbdGFiSW5kZXhdPVwiLTFcIlxuICAgICAgICAgICAgW2NsYXNzXT1cIl9jbGFzcygpXCJcbiAgICAgICAgICAgIGRhdGEtc29ubmVyLXRvYXN0ZXJcbiAgICAgICAgICAgIFthdHRyLmRhdGEtdGhlbWVdPVwiYWN0dWFsVGhlbWUoKVwiXG4gICAgICAgICAgICBbYXR0ci5kYXRhLXJpY2gtY29sb3JzXT1cInJpY2hDb2xvcnMoKVwiXG4gICAgICAgICAgICBbYXR0ci5kaXJdPVwiZGlyKCkgPT09ICdhdXRvJyA/IGdldERvY3VtZW50RGlyZWN0aW9uKCkgOiBkaXIoKVwiXG4gICAgICAgICAgICBbYXR0ci5kYXRhLXktcG9zaXRpb25dPVwicG9zLnNwbGl0KCctJylbMF1cIlxuICAgICAgICAgICAgW2F0dHIuZGF0YS14LXBvc2l0aW9uXT1cInBvcy5zcGxpdCgnLScpWzFdXCJcbiAgICAgICAgICAgIChibHVyKT1cImhhbmRsZUJsdXIoJGV2ZW50KVwiXG4gICAgICAgICAgICAoZm9jdXMpPVwiaGFuZGxlRm9jdXMoJGV2ZW50KVwiXG4gICAgICAgICAgICAobW91c2VlbnRlcik9XCJleHBhbmRlZC5zZXQodHJ1ZSlcIlxuICAgICAgICAgICAgKG1vdXNlbW92ZSk9XCJleHBhbmRlZC5zZXQodHJ1ZSlcIlxuICAgICAgICAgICAgKG1vdXNlbGVhdmUpPVwiaGFuZGxlTW91c2VMZWF2ZSgpXCJcbiAgICAgICAgICAgIChwb2ludGVyZG93bik9XCJoYW5kbGVQb2ludGVyRG93bigkZXZlbnQpXCJcbiAgICAgICAgICAgIChwb2ludGVydXApPVwiaW50ZXJhY3Rpbmcuc2V0KGZhbHNlKVwiXG4gICAgICAgICAgICBbc3R5bGVdPVwidG9hc3RlclN0eWxlcygpXCI+XG4gICAgICAgICAgICBAZm9yIChcbiAgICAgICAgICAgICAgdG9hc3Qgb2YgdG9hc3RzKCkgfCB0b2FzdEZpbHRlcjogJGluZGV4IDogcG9zO1xuICAgICAgICAgICAgICB0cmFjayB0b2FzdC5pZFxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgIDxuZ3gtc29ubmVyLXRvYXN0XG4gICAgICAgICAgICAgICAgW2luZGV4XT1cIiRpbmRleFwiXG4gICAgICAgICAgICAgICAgW3RvYXN0XT1cInRvYXN0XCJcbiAgICAgICAgICAgICAgICBbaW52ZXJ0XT1cImludmVydCgpXCJcbiAgICAgICAgICAgICAgICBbdmlzaWJsZVRvYXN0c109XCJ2aXNpYmxlVG9hc3RzKClcIlxuICAgICAgICAgICAgICAgIFtjbG9zZUJ1dHRvbl09XCJjbG9zZUJ1dHRvbigpXCJcbiAgICAgICAgICAgICAgICBbaW50ZXJhY3RpbmddPVwiaW50ZXJhY3RpbmcoKVwiXG4gICAgICAgICAgICAgICAgW3Bvc2l0aW9uXT1cInBvc2l0aW9uKClcIlxuICAgICAgICAgICAgICAgIFtleHBhbmRCeURlZmF1bHRdPVwiZXhwYW5kKClcIlxuICAgICAgICAgICAgICAgIFtleHBhbmRlZF09XCJleHBhbmRlZCgpXCJcbiAgICAgICAgICAgICAgICBbYWN0aW9uQnV0dG9uU3R5bGVdPVwidG9hc3RPcHRpb25zKCkuYWN0aW9uQnV0dG9uU3R5bGVcIlxuICAgICAgICAgICAgICAgIFtjYW5jZWxCdXR0b25TdHlsZV09XCJ0b2FzdE9wdGlvbnMoKS5jYW5jZWxCdXR0b25TdHlsZVwiXG4gICAgICAgICAgICAgICAgW2NsYXNzXT1cInRvYXN0T3B0aW9ucygpLmNsYXNzID8/ICcnXCJcbiAgICAgICAgICAgICAgICBbZGVzY3JpcHRpb25DbGFzc109XCJ0b2FzdE9wdGlvbnMoKS5kZXNjcmlwdGlvbkNsYXNzID8/ICcnXCJcbiAgICAgICAgICAgICAgICBbY2xhc3Nlc109XCJ0b2FzdE9wdGlvbnMoKS5jbGFzc2VzID8/IHt9XCJcbiAgICAgICAgICAgICAgICBbZHVyYXRpb25dPVwidG9hc3RPcHRpb25zKCkuZHVyYXRpb24gPz8gZHVyYXRpb24oKVwiXG4gICAgICAgICAgICAgICAgW3Vuc3R5bGVkXT1cInRvYXN0T3B0aW9ucygpLnVuc3R5bGVkID8/IGZhbHNlXCI+XG4gICAgICAgICAgICAgICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwiW2xvYWRpbmctaWNvbl1cIiBsb2FkaW5nLWljb24+XG4gICAgICAgICAgICAgICAgICA8bmd4LXNvbm5lci1sb2FkZXIgW2lzVmlzaWJsZV09XCJ0b2FzdC50eXBlID09PSAnbG9hZGluZydcIiAvPlxuICAgICAgICAgICAgICAgIDwvbmctY29udGVudD5cbiAgICAgICAgICAgICAgICA8bmctY29udGVudCBzZWxlY3Q9XCJbc3VjY2Vzcy1pY29uXVwiIHN1Y2Nlc3MtaWNvbj5cbiAgICAgICAgICAgICAgICAgIDxuZ3gtc29ubmVyLWljb24gdHlwZT1cInN1Y2Nlc3NcIiAvPlxuICAgICAgICAgICAgICAgIDwvbmctY29udGVudD5cbiAgICAgICAgICAgICAgICA8bmctY29udGVudCBzZWxlY3Q9XCJbZXJyb3ItaWNvbl1cIiBlcnJvci1pY29uPlxuICAgICAgICAgICAgICAgICAgPG5neC1zb25uZXItaWNvbiB0eXBlPVwiZXJyb3JcIiAvPlxuICAgICAgICAgICAgICAgIDwvbmctY29udGVudD5cbiAgICAgICAgICAgICAgICA8bmctY29udGVudCBzZWxlY3Q9XCJbd2FybmluZy1pY29uXVwiIHdhcm5pbmctaWNvbj5cbiAgICAgICAgICAgICAgICAgIDxuZ3gtc29ubmVyLWljb24gdHlwZT1cIndhcm5pbmdcIiAvPlxuICAgICAgICAgICAgICAgIDwvbmctY29udGVudD5cbiAgICAgICAgICAgICAgICA8bmctY29udGVudCBzZWxlY3Q9XCJbaW5mby1pY29uXVwiIGluZm8taWNvbj5cbiAgICAgICAgICAgICAgICAgIDxuZ3gtc29ubmVyLWljb24gdHlwZT1cImluZm9cIiAvPlxuICAgICAgICAgICAgICAgIDwvbmctY29udGVudD5cbiAgICAgICAgICAgICAgPC9uZ3gtc29ubmVyLXRvYXN0PlxuICAgICAgICAgICAgfVxuICAgICAgICAgIDwvb2w+XG4gICAgICAgIH1cbiAgICAgIDwvc2VjdGlvbj5cbiAgICB9XG4gIGAsXG4gIHN0eWxlVXJsOiAndG9hc3Rlci5jb21wb25lbnQuY3NzJyxcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG59KVxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEBhbmd1bGFyLWVzbGludC9jb21wb25lbnQtY2xhc3Mtc3VmZml4XG5leHBvcnQgY2xhc3MgTmd4U29ubmVyVG9hc3RlciBpbXBsZW1lbnRzIE9uRGVzdHJveSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgcGxhdGZvcm1JZCA9IGluamVjdChQTEFURk9STV9JRCk7XG5cbiAgdG9hc3RzID0gdG9hc3RTdGF0ZS50b2FzdHM7XG4gIGhlaWdodHMgPSB0b2FzdFN0YXRlLmhlaWdodHM7XG4gIHJlc2V0ID0gdG9hc3RTdGF0ZS5yZXNldDtcblxuICBpbnZlcnQgPSBpbnB1dDxUb2FzdGVyUHJvcHNbJ2ludmVydCddLCBib29sZWFuIHwgc3RyaW5nPihmYWxzZSwge1xuICAgIHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSxcbiAgfSk7XG4gIHRoZW1lID0gaW5wdXQ8VG9hc3RlclByb3BzWyd0aGVtZSddPignbGlnaHQnKTtcbiAgcG9zaXRpb24gPSBpbnB1dDxUb2FzdGVyUHJvcHNbJ3Bvc2l0aW9uJ10+KCdib3R0b20tcmlnaHQnKTtcbiAgaG90S2V5ID0gaW5wdXQ8VG9hc3RlclByb3BzWydob3RrZXknXT4oWydhbHRLZXknLCAnS2V5VCddKTtcbiAgcmljaENvbG9ycyA9IGlucHV0PFRvYXN0ZXJQcm9wc1sncmljaENvbG9ycyddLCBib29sZWFuIHwgc3RyaW5nPihmYWxzZSwge1xuICAgIHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSxcbiAgfSk7XG4gIGV4cGFuZCA9IGlucHV0PFRvYXN0ZXJQcm9wc1snZXhwYW5kJ10sIGJvb2xlYW4gfCBzdHJpbmc+KGZhbHNlLCB7XG4gICAgdHJhbnNmb3JtOiBib29sZWFuQXR0cmlidXRlLFxuICB9KTtcbiAgZHVyYXRpb24gPSBpbnB1dDxUb2FzdGVyUHJvcHNbJ2R1cmF0aW9uJ10sIG51bWJlciB8IHN0cmluZz4oVE9BU1RfTElGRVRJTUUsIHtcbiAgICB0cmFuc2Zvcm06IG51bWJlckF0dHJpYnV0ZSxcbiAgfSk7XG4gIHZpc2libGVUb2FzdHMgPSBpbnB1dDxUb2FzdGVyUHJvcHNbJ3Zpc2libGVUb2FzdHMnXSwgbnVtYmVyIHwgc3RyaW5nPihcbiAgICBWSVNJQkxFX1RPQVNUU19BTU9VTlQsXG4gICAgeyB0cmFuc2Zvcm06IG51bWJlckF0dHJpYnV0ZSB9XG4gICk7XG4gIGNsb3NlQnV0dG9uID0gaW5wdXQ8VG9hc3RlclByb3BzWydjbG9zZUJ1dHRvbiddLCBib29sZWFuIHwgc3RyaW5nPihmYWxzZSwge1xuICAgIHRyYW5zZm9ybTogYm9vbGVhbkF0dHJpYnV0ZSxcbiAgfSk7XG4gIHRvYXN0T3B0aW9ucyA9IGlucHV0PFRvYXN0ZXJQcm9wc1sndG9hc3RPcHRpb25zJ10+KHt9KTtcbiAgb2Zmc2V0ID0gaW5wdXQ8VG9hc3RlclByb3BzWydvZmZzZXQnXT4obnVsbCk7XG4gIGRpciA9IGlucHV0PFRvYXN0ZXJQcm9wc1snZGlyJ10+KHRoaXMuZ2V0RG9jdW1lbnREaXJlY3Rpb24oKSk7XG4gIF9jbGFzcyA9IGlucHV0KCcnLCB7IGFsaWFzOiAnY2xhc3MnIH0pO1xuICBfc3R5bGUgPSBpbnB1dDxSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+Pih7fSwgeyBhbGlhczogJ3N0eWxlJyB9KTtcblxuICBwb3NzaWJsZVBvc2l0aW9ucyA9IGNvbXB1dGVkKFxuICAgICgpID0+XG4gICAgICBBcnJheS5mcm9tKFxuICAgICAgICBuZXcgU2V0KFxuICAgICAgICAgIFtcbiAgICAgICAgICAgIHRoaXMucG9zaXRpb24oKSxcbiAgICAgICAgICAgIC4uLnRoaXMudG9hc3RzKClcbiAgICAgICAgICAgICAgLmZpbHRlcih0b2FzdCA9PiB0b2FzdC5wb3NpdGlvbilcbiAgICAgICAgICAgICAgLm1hcCh0b2FzdCA9PiB0b2FzdC5wb3NpdGlvbiksXG4gICAgICAgICAgXS5maWx0ZXIoQm9vbGVhbilcbiAgICAgICAgKVxuICAgICAgKSBhcyBQb3NpdGlvbltdXG4gICk7XG5cbiAgZXhwYW5kZWQgPSBzaWduYWwoZmFsc2UpO1xuICBpbnRlcmFjdGluZyA9IHNpZ25hbChmYWxzZSk7XG4gIGFjdHVhbFRoZW1lID0gc2lnbmFsKHRoaXMuZ2V0QWN0dWFsVGhlbWUodGhpcy50aGVtZSgpKSk7XG5cbiAgbGlzdFJlZiA9IHZpZXdDaGlsZDxFbGVtZW50UmVmPEhUTUxPTGlzdEVsZW1lbnQ+PignbGlzdFJlZicpO1xuICBsYXN0Rm9jdXNlZEVsZW1lbnRSZWYgPSBzaWduYWw8SFRNTEVsZW1lbnQgfCBudWxsPihudWxsKTtcbiAgaXNGb2N1c1dpdGhpblJlZiA9IHNpZ25hbChmYWxzZSk7XG5cbiAgaG90S2V5TGFiZWwgPSBjb21wdXRlZCgoKSA9PlxuICAgIHRoaXMuaG90S2V5KCkuam9pbignKycpLnJlcGxhY2UoL0tleS9nLCAnJykucmVwbGFjZSgvRGlnaXQvZywgJycpXG4gICk7XG5cbiAgdG9hc3RlclN0eWxlcyA9IGNvbXB1dGVkKCgpID0+ICh7XG4gICAgJy0tZnJvbnQtdG9hc3QtaGVpZ2h0JzogYCR7dGhpcy5oZWlnaHRzKClbMF0/LmhlaWdodH1weGAsXG4gICAgJy0tb2Zmc2V0JzpcbiAgICAgIHR5cGVvZiB0aGlzLm9mZnNldCgpID09PSAnbnVtYmVyJ1xuICAgICAgICA/IGAke3RoaXMub2Zmc2V0KCl9cHhgXG4gICAgICAgIDogdGhpcy5vZmZzZXQoKSA/PyBgJHtWSUVXUE9SVF9PRkZTRVR9YCxcbiAgICAnLS13aWR0aCc6IGAke1RPQVNUX1dJRFRIfXB4YCxcbiAgICAnLS1nYXAnOiBgJHtHQVB9cHhgLFxuICAgIC4uLnRoaXMuX3N0eWxlKCksXG4gIH0pKTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnJlc2V0KCk7XG5cbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybUlkKSkge1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlS2V5ZG93bik7XG4gICAgICB3aW5kb3dcbiAgICAgICAgLm1hdGNoTWVkaWEoJyhwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyayknKVxuICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5oYW5kbGVUaGVtZVByZWZlcmVuY2VDaGFuZ2UpO1xuICAgIH1cblxuICAgIGVmZmVjdCgoKSA9PiB7XG4gICAgICBpZiAodGhpcy50b2FzdHMoKS5sZW5ndGggPj0gMSkge1xuICAgICAgICB1bnRyYWNrZWQoKCkgPT4gdGhpcy5leHBhbmRlZC5zZXQoZmFsc2UpKTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGVmZmVjdCgoKSA9PiB7XG4gICAgICBjb25zdCB0aGVtZSA9IHRoaXMudGhlbWUoKTtcbiAgICAgIHVudHJhY2tlZCgoKSA9PiB0aGlzLmFjdHVhbFRoZW1lLnNldCh0aGlzLmdldEFjdHVhbFRoZW1lKHRoZW1lKSkpO1xuICAgIH0pO1xuICB9XG5cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmhhbmRsZUtleWRvd24pO1xuICAgICAgd2luZG93XG4gICAgICAgIC5tYXRjaE1lZGlhKCcocHJlZmVycy1jb2xvci1zY2hlbWU6IGRhcmspJylcbiAgICAgICAgLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMuaGFuZGxlVGhlbWVQcmVmZXJlbmNlQ2hhbmdlKTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVCbHVyKGV2ZW50OiBGb2N1c0V2ZW50KSB7XG4gICAgaWYgKFxuICAgICAgdGhpcy5pc0ZvY3VzV2l0aGluUmVmKCkgJiZcbiAgICAgICEoZXZlbnQudGFyZ2V0IGFzIEhUTUxPTGlzdEVsZW1lbnQpLmNvbnRhaW5zKFxuICAgICAgICBldmVudC5yZWxhdGVkVGFyZ2V0IGFzIEhUTUxFbGVtZW50XG4gICAgICApXG4gICAgKSB7XG4gICAgICB0aGlzLmlzRm9jdXNXaXRoaW5SZWYuc2V0KGZhbHNlKTtcbiAgICAgIGlmICh0aGlzLmxhc3RGb2N1c2VkRWxlbWVudFJlZigpKSB7XG4gICAgICAgIHRoaXMubGFzdEZvY3VzZWRFbGVtZW50UmVmKCk/LmZvY3VzKHsgcHJldmVudFNjcm9sbDogdHJ1ZSB9KTtcbiAgICAgICAgdGhpcy5sYXN0Rm9jdXNlZEVsZW1lbnRSZWYuc2V0KG51bGwpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGhhbmRsZUZvY3VzKGV2ZW50OiBGb2N1c0V2ZW50KSB7XG4gICAgY29uc3QgaXNOb3REaXNtaXNzaWJsZSA9XG4gICAgICBldmVudC50YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJlxuICAgICAgZXZlbnQudGFyZ2V0LmRhdGFzZXRbJ2Rpc21pc3NpYmxlJ10gPT09ICdmYWxzZSc7XG5cbiAgICBpZiAoaXNOb3REaXNtaXNzaWJsZSkgcmV0dXJuO1xuXG4gICAgaWYgKCF0aGlzLmlzRm9jdXNXaXRoaW5SZWYoKSkge1xuICAgICAgdGhpcy5pc0ZvY3VzV2l0aGluUmVmLnNldCh0cnVlKTtcbiAgICAgIHRoaXMubGFzdEZvY3VzZWRFbGVtZW50UmVmLnNldChldmVudC5yZWxhdGVkVGFyZ2V0IGFzIEhUTUxFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBoYW5kbGVQb2ludGVyRG93bihldmVudDogTW91c2VFdmVudCkge1xuICAgIGNvbnN0IGlzTm90RGlzbWlzc2libGUgPVxuICAgICAgZXZlbnQudGFyZ2V0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgJiZcbiAgICAgIGV2ZW50LnRhcmdldC5kYXRhc2V0WydkaXNtaXNzaWJsZSddID09PSAnZmFsc2UnO1xuXG4gICAgaWYgKGlzTm90RGlzbWlzc2libGUpIHJldHVybjtcbiAgICB0aGlzLmludGVyYWN0aW5nLnNldCh0cnVlKTtcbiAgfVxuXG4gIGhhbmRsZU1vdXNlTGVhdmUoKSB7XG4gICAgaWYgKCF0aGlzLmludGVyYWN0aW5nKCkpIHtcbiAgICAgIHRoaXMuZXhwYW5kZWQuc2V0KGZhbHNlKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZUtleWRvd24gPSAoZXZlbnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICBjb25zdCBsaXN0UmVmID0gdGhpcy5saXN0UmVmKCk/Lm5hdGl2ZUVsZW1lbnQ7XG4gICAgaWYgKCFsaXN0UmVmKSByZXR1cm47XG5cbiAgICBjb25zdCBpc0hvdGtleVByZXNzZWQgPSB0aGlzLmhvdEtleSgpLmV2ZXJ5KFxuICAgICAga2V5ID0+IChldmVudCBhcyBuZXZlcilba2V5XSB8fCBldmVudC5jb2RlID09PSBrZXlcbiAgICApO1xuXG4gICAgaWYgKGlzSG90a2V5UHJlc3NlZCkge1xuICAgICAgdGhpcy5leHBhbmRlZC5zZXQodHJ1ZSk7XG4gICAgICBsaXN0UmVmLmZvY3VzKCk7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgZXZlbnQuY29kZSA9PT0gJ0VzY2FwZScgJiZcbiAgICAgIChkb2N1bWVudC5hY3RpdmVFbGVtZW50ID09PSBsaXN0UmVmIHx8XG4gICAgICAgIGxpc3RSZWYuY29udGFpbnMoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkpXG4gICAgKSB7XG4gICAgICB0aGlzLmV4cGFuZGVkLnNldChmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIHByaXZhdGUgaGFuZGxlVGhlbWVQcmVmZXJlbmNlQ2hhbmdlID0gKHsgbWF0Y2hlcyB9OiBNZWRpYVF1ZXJ5TGlzdEV2ZW50KSA9PiB7XG4gICAgaWYgKHRoaXMudGhlbWUoKSA9PT0gJ3N5c3RlbScpIHtcbiAgICAgIHRoaXMuYWN0dWFsVGhlbWUuc2V0KG1hdGNoZXMgPyAnZGFyaycgOiAnbGlnaHQnKTtcbiAgICB9XG4gIH07XG5cbiAgcHJpdmF0ZSBnZXRBY3R1YWxUaGVtZSh0OiBUaGVtZSkge1xuICAgIGlmICh0ICE9PSAnc3lzdGVtJykge1xuICAgICAgcmV0dXJuIHQ7XG4gICAgfVxuXG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm1JZCkpIHtcbiAgICAgIGlmIChcbiAgICAgICAgd2luZG93Lm1hdGNoTWVkaWEgJiZcbiAgICAgICAgd2luZG93Lm1hdGNoTWVkaWEoJyhwcmVmZXJzLWNvbG9yLXNjaGVtZTogZGFyayknKS5tYXRjaGVzXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuICdkYXJrJztcbiAgICAgIH1cblxuICAgICAgcmV0dXJuICdsaWdodCc7XG4gICAgfVxuXG4gICAgcmV0dXJuICdsaWdodCc7XG4gIH1cblxuICBnZXREb2N1bWVudERpcmVjdGlvbigpOiBUb2FzdGVyUHJvcHNbJ2RpciddIHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCcpIHJldHVybiAnbHRyJztcbiAgICBpZiAodHlwZW9mIGRvY3VtZW50ID09PSAndW5kZWZpbmVkJykgcmV0dXJuICdsdHInOyAvLyBGb3IgRnJlc2ggcHVycG9zZVxuXG4gICAgY29uc3QgZGlyQXR0cmlidXRlID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGlyJyk7XG5cbiAgICBpZiAoZGlyQXR0cmlidXRlID09PSAnYXV0bycgfHwgIWRpckF0dHJpYnV0ZSkge1xuICAgICAgcmV0dXJuIHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudClcbiAgICAgICAgLmRpcmVjdGlvbiBhcyBUb2FzdGVyUHJvcHNbJ2RpciddO1xuICAgIH1cblxuICAgIHJldHVybiBkaXJBdHRyaWJ1dGUgYXMgVG9hc3RlclByb3BzWydkaXInXTtcbiAgfVxufVxuIl19